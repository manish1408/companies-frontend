<div class="row">
    <div class="col-9">
      <h4 class="title">Companies</h4>
      <p class="desc">
        Manage your companies and their details.
      </p>
    </div>
    <div class="col-3">
      <button type="button" class="btn btn-primary float-end" data-bs-toggle="modal" data-bs-target="#addCompanyModal">
        <img src="assets/icons/plus.svg" /> Add New company
      </button>
    </div>
  </div>

  <!-- Companies Table -->
  <div class="table-responsive mt-4" *ngIf="companies.length > 0">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Company Name</th>
          <th scope="col">Status</th>
          <th scope="col">Jurisdiction</th>
          <th scope="col">Date of Incorporation</th>
          <th scope="col">Address</th>
          <th scope="col">Country</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let company of companies">
          <td>{{ company.companyName }}</td>
          <td>
            <span class="badge badge rounded-pill text-bg-success"
                  *ngIf="company.status === 'Incorporated'">Incorporated</span>
            <span class="badge badge rounded-pill text-bg-warning"
                  *ngIf="company.status === 'Incorporation Requested'">Incorporation Requested</span>
            <span class="badge badge rounded-pill text-bg-secondary"
                  *ngIf="company.status !== 'Incorporated' && company.status !== 'Incorporation Requested'">{{ company.status }}</span>
          </td>
          <td>{{ company.jurisdiction }}</td>
          <td>{{ company.dateOfIncorporation }}</td>
          <td>{{ company.companyAddress }}</td>
          <td>{{ company.companyCountry }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty state -->
  <div class="text-center mt-5" *ngIf="companies.length === 0">
    <p class="text-muted">No companies found. Add your first company to get started.</p>
  </div>

  <!-- Add Company Modal -->
  <div class="modal fade" id="addCompanyModal" tabindex="-1" aria-labelledby="addCompanyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addCompanyModalLabel">Create New Company</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form [formGroup]="companyForm" (ngSubmit)="onSubmit()">
            <div class="row">
              <!-- Select Jurisdiction -->
              <div class="col-md-6 mb-3">
                <label for="jurisdiction" class="form-label">Select Jurisdiction</label>
                <select class="form-select" id="jurisdiction" formControlName="jurisdiction" 
                        [ngClass]="{ 'is-invalid': hasError('jurisdiction') }">
                  <option value="">Select Jurisdiction</option>
                  <option *ngFor="let country of countries" [value]="country.name">{{ country.name }}</option>
                </select>
                <div class="invalid-feedback" *ngIf="hasError('jurisdiction')">
                  Jurisdiction is required
                </div>
              </div>

              <!-- Desired Company Name -->
              <div class="col-md-6 mb-3">
                <label for="companyName" class="form-label">Desired Company Name</label>
                <input type="text" class="form-control" id="companyName" formControlName="companyName" 
                       placeholder="Enter company name" [ngClass]="{ 'is-invalid': hasError('companyName') }">
                <div class="invalid-feedback" *ngIf="hasError('companyName')">
                  Company name is required
                </div>
              </div>

              <!-- Company Address -->
              <div class="col-12 mb-3">
                <label for="companyAddress" class="form-label">Company Address</label>
                <textarea class="form-control" id="companyAddress" formControlName="companyAddress" 
                          rows="3" placeholder="Enter company address" [ngClass]="{ 'is-invalid': hasError('companyAddress') }"></textarea>
                <div class="invalid-feedback" *ngIf="hasError('companyAddress')">
                  Company address is required
                </div>
              </div>

              <!-- Company Post/Zip Code -->
              <div class="col-md-6 mb-3">
                <label for="zip" class="form-label">Company Post/Zip Code</label>
                <input type="text" class="form-control" id="zip" formControlName="zip" 
                       placeholder="Enter post/zip code" [ngClass]="{ 'is-invalid': hasError('zip') }">
                <div class="invalid-feedback" *ngIf="hasError('zip')">
                  Post/Zip code is required
                </div>
              </div>

              <!-- Company Country -->
              <div class="col-md-6 mb-3">
                <label for="country" class="form-label">Company Country</label>
                <select class="form-select" id="country" formControlName="country" 
                        [ngClass]="{ 'is-invalid': hasError('country') }">
                  <option value="">Select Country</option>
                  <option *ngFor="let country of countries" [value]="country.name">{{ country.name }}</option>
                </select>
                <div class="invalid-feedback" *ngIf="hasError('country')">
                  Company country is required
                </div>
              </div>

              <!-- Number of Directors -->
              <div class="col-md-6 mb-3">
                <label for="directors" class="form-label">Number of Directors</label>
                <select class="form-select" id="directors" formControlName="directors" 
                        [ngClass]="{ 'is-invalid': hasError('directors') }">
                  <option value="">Select number</option>
                  <option *ngFor="let num of directorNumbers" [value]="num">{{ num }}</option>
                </select>
                <div class="invalid-feedback" *ngIf="hasError('directors')">
                  Number of directors is required
                </div>
              </div>

              <!-- Number of Shareholders -->
              <div class="col-md-6 mb-3">
                <label for="shareholders" class="form-label">Number of Shareholders</label>
                <select class="form-select" id="shareholders" formControlName="shareholders" 
                        [ngClass]="{ 'is-invalid': hasError('shareholders') }">
                  <option value="">Select number</option>
                  <option *ngFor="let num of shareholderNumbers" [value]="num">{{ num }}</option>
                </select>
                <div class="invalid-feedback" *ngIf="hasError('shareholders')">
                  Number of shareholders is required
                </div>
              </div>

              <!-- Company Activities -->
              <div class="col-12 mb-3">
                <label for="companyActivities" class="form-label">Company Activities</label>
                <textarea class="form-control" id="companyActivities" formControlName="companyActivities" 
                          rows="3" placeholder="Describe company activities" [ngClass]="{ 'is-invalid': hasError('companyActivities') }"></textarea>
                <div class="invalid-feedback" *ngIf="hasError('companyActivities')">
                  Company activities is required
                </div>
              </div>

              <!-- Company SEC Code -->
              <div class="col-12 mb-3">
                <label for="secCode" class="form-label">Company SEC Code</label>
                <input type="text" class="form-control" id="secCode" formControlName="secCode" 
                       placeholder="Enter SEC code" [ngClass]="{ 'is-invalid': hasError('secCode') }">
                <div class="invalid-feedback" *ngIf="hasError('secCode')">
                  SEC code is required
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" (click)="onSubmit()" [disabled]="companyForm.invalid || loading">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            {{ loading ? 'Creating...' : 'Create Company' }}
          </button>
        </div>
      </div>
    </div>
  </div>